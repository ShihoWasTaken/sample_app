<div class="col-xs-10 col-xs-offset-1 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3 col-lg-8 col-lg-offset-2" id="content">
	<h1>Statistiques du site</h1>
  <div class="col-md-6">
		<script src="/highcharts/highcharts.js"></script>
		<script src="/highcharts/highcharts-more.js"></script>

    <div  class='hidden' id="cinema"><%= @cinemaArray %></div>
    <div  class='hidden' id="tv"><%= @TVArray %></div>
    <div  class='hidden' id="computer"><%= @computerArray %></div>
    <div  class='hidden' id="tablet"><%= @tabletArray %></div>

		<div id="container" style="height: 400px; margin: auto; min-width: 310px; max-width: 600px"></div>
	</div>
	<div class="col-md-6">
    <div  class='hidden' id="lecteurs"><%= @lecteurs %></div>
    <div  class='hidden' id="non-lecteurs"><%= @nonLecteurs %></div>
		<div  id='chart_div'></div>
    <div class="col-md-4 col-md-offset-2">
      <div>Lecteurs: <%= @lecteurs %>% (<%= @totalLecteurs %>/<%= @totalUsers %>)</div>
    </div>
    <div class="col-md-6">
      <div>Non lecteurs: <%= @nonLecteurs %>% (<%= @totalNonLecteurs %>/<%= @totalUsers %>)</div>
    </div>
	</div>

</div>
<script type="text/javascript" src="/js/loader.js"></script>

  <script type="text/javascript">
  $( document ).ready(function() {
    var lecteurs = parseInt($('#lecteurs').text());
    var nonLecteurs = parseInt($('#non-lecteurs').text());
    google.charts.load('43', {packages:['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
      var data = google.visualization.arrayToDataTable([
        ['Element', 'Density', { role: 'style' }],
        ['Lecteurs', lecteurs, 'gold'],
        ['Non-lecteurs', nonLecteurs, 'color: #e5e4e2' ]
      ]);
      var options = {
        title: "Pourcentage des lecteurs/non-lecteurs parmi les utilisateurs",
        bar: {groupWidth: '50%'},
        legend: 'none',
        showValueLabels: true,
        width: '100%',
        height: 500,
      };
      var chart_div = document.getElementById('chart_div');
      var chart = new google.visualization.ColumnChart(chart_div);
      // Wait for the chart to finish drawing before calling the getImageURI() method.
      google.visualization.events.addListener(chart, 'ready', function () {
        chart_div.innerHTML = '<img src="' + chart.getImageURI() + '">';
      });
      chart.draw(data, options);
    }
  });
  </script>

<script type="text/javascript">
$(function () {
  var cinemaArray = $('#cinema').text();
  cinemaArray = $.parseJSON( '[' + cinemaArray + ']' );

  var TVArray = $('#tv').text();
  TVArray = $.parseJSON( '[' + TVArray + ']' );
  
  var computerArray = $('#computer').text();
  computerArray = $.parseJSON( '[' + computerArray + ']' );

  var tabletArray = $('#tablet').text();
  tabletArray = $.parseJSON( '[' + tabletArray + ']' );

 $('#container').highcharts({

        chart: {
            type: 'boxplot'
        },

        title: {
            text: 'Box plot des films vus en fonction du support'
        },
        credits: {
            enabled: false
        },

        legend: {
            enabled: false
        },

        xAxis: {
            categories: ['Cin√©ma', 'TV', 'Ordinateur', 'Tablette'],
            title: {
                text: 'Support de visionnage'
            }
        },

        yAxis: {
            title: {
                text: 'Nombre de films vus par semaine'
            }
        },

        series: [{
            name: 'Nombre de films vus par semaine',
            data: [
                cinemaArray,
                TVArray,
                computerArray,
                tabletArray
            ],
            tooltip: {
                headerFormat: '<em>Support de visionnage: {point.key}</em><br/>'
            }
        }]

    });
});
</script>